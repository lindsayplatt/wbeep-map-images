
include:
  - 1_fetch.yml

packages:
  - sf
  - geojsonio

sources:
  - 2_process/src/process_hru_sf.R

targets:
  all: 
    depends: 
      - 2_process/out/hru_sf.rds
      - 2_process/out/hru_conus_sf.rds

  proj_topo_start: 
    command: c(I('+proj=lcc +lat_1=43.26666666666667 +lat_2=42.06666666666667 +lat_0=41.5 +lon_0=-93.5 +x_0=1500000 +y_0=1000000 +ellps=GRS80 +datum=NAD83 +units=m +no_defs'))
  
  2_process/out/hru_sf.rds:
    command: topo_to_sf(
      target_name = target_name,
      topo_fn = '1_fetch/out/hru.topojson', 
      proj_start = proj_topo_start,
      proj_target = proj)

  # Crop hru spatial data to just CONUS
  2_process/out/hru_conus_sf.rds:
    command: crop_hru_to_conus(
      target_name = target_name,
      hru_sf_fn = '2_process/out/hru_sf.rds', 
      conus_sf_fn = '1_fetch/out/conus_sf.rds')
